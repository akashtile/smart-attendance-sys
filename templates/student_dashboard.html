<!DOCTYPE html>
<html>
<head>
  <title>Student Dashboard</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<div class="layout">

  <!-- Sidebar -->
  <div class="sidebar">
    <h2 class="logo">Attendance</h2>

    <a href="/student-dashboard" class="active">
      <i class="fa-solid fa-chart-line"></i> Dashboard
    </a>

    <a href="/student-records">
      <i class="fa-solid fa-table"></i> Attendance Records
    </a>

    <a href="/student-notifications">
      <i class="fa-solid fa-bell"></i> Notifications
    </a>

    <a href="/logout">
      <i class="fa-solid fa-right-from-bracket"></i> Logout
    </a>
  </div>

  <!-- Main Content -->
  <div class="main">
    <h1>ðŸŽ“ Student Dashboard</h1>

    <!-- Cards -->
    <div class="cards">
      <div class="card blue">
        <p>Total Classes</p>
        <h2 id="total">0</h2>
      </div>

      <div class="card green">
        <p>Present</p>
        <h2 id="present">0</h2>
      </div>

      <div class="card red">
        <p>Absent</p>
        <h2 id="absent">0</h2>
      </div>
    </div>

    <!-- Chart -->
    <div class="chart-card">
      <h3>Attendance Overview</h3>
      <canvas id="attendanceChart"></canvas>
    </div>

    <!-- Notifications -->
    <div class="chart-card">
      <h3>ðŸ”” Notifications</h3>
      <ul id="notifications">
        <li>You were absent on 21-01-2026</li>
        <li>Attendance marked successfully on 20-01-2026</li>
      </ul>
    </div>
  </div>

</div>

<script>
let chart;

async function loadStudentStats() {
  const res = await fetch("/api/student/stats");
  const data = await res.json();

  document.getElementById("total").innerText = data.total;
  document.getElementById("present").innerText = data.present;
  document.getElementById("absent").innerText = data.absent;

  drawChart(data.present, data.absent);
}

function drawChart(present, absent) {
  const ctx = document.getElementById("attendanceChart");

  if (chart) chart.destroy();

  chart = new Chart(ctx, {
    type: "doughnut",
    data: {
      labels: ["Present", "Absent"],
      datasets: [{
        data: [present, absent],
        backgroundColor: ["#22c55e", "#ef4444"]
      }]
    },
    options: {
      plugins: {
        legend: { position: "bottom" }
      }
    }
  });
}

loadStudentStats();
</script>

</body>
</html>
