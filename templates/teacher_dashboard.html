<!DOCTYPE html>
<html>
<head>
  <title>Teacher Dashboard</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="layout">

  <!-- Sidebar -->
  <div class="sidebar">
    <h2 class="logo">Attendance</h2>
    <a class="active" href="/teacher-dashboard"><i class="fa-solid fa-chart-line"></i> Dashboard</a>
    <a href="/live"><i class="fa-solid fa-camera"></i> Live Attendance</a>
    <a href="/register"><i class="fa-solid fa-user-plus"></i> Register Student</a>
    <a href="/records"><i class="fa-solid fa-table"></i> Records</a>
    <a href="/students"><i class="fa-solid fa-users"></i> Students</a>
  </div>

  <!-- Main -->
  <div class="main">
    <h1>ğŸ‘©â€ğŸ« Teacher Dashboard</h1>

    <div class="cards">
      <div class="card blue"><p>Total Students</p><h2 id="total">0</h2></div>
      <div class="card green"><p>Present Today</p><h2 id="present">0</h2></div>
      <div class="card red"><p>Absent Today</p><h2 id="absent">0</h2></div>
    </div>

    <div class="chart-card">
      <h3>Today's Attendance</h3>
      <canvas id="attendanceChart"></canvas>
    </div>
  </div>
</div>

<script>
let chart;
async function loadStats(){
  const res = await fetch("/api/stats");
  const data = await res.json();

  total.innerText = data.total;
  present.innerText = data.present;
  absent.innerText = data.absent;

  if(chart) chart.destroy();
  chart = new Chart(attendanceChart,{
    type:"doughnut",
    data:{
      labels:["Present","Absent"],
      datasets:[{data:[data.present,data.absent],
      backgroundColor:["#22c55e","#ef4444"]}]
    }
  });
}
loadStats();
</script>
</body>
</html>
